#!/bin/bash
set -e

#--------------------------------------------------------------------------------------------------
# Settings
#--------------------------------------------------------------------------------------------------

target="zxing-cpp"

path="../src/SkBarcode/src/3rdparty/$target"

hash="f89db69e34543c508f80e807535dab3012eea7ad" # Pre-2.0

projectGenerator="$PWD/../deploy/projectGenerator"

#--------------------------------------------------------------------------------------------------
# Clone
#--------------------------------------------------------------------------------------------------

git clone "https://github.com/zxing-cpp/zxing-cpp"

cd $target

git checkout $hash

cd ..

echo ""

#--------------------------------------------------------------------------------------------------
# Copy
#--------------------------------------------------------------------------------------------------

rm -rf $path/*

cp -r $target/core/src/* $path

rm -rf $target

#--------------------------------------------------------------------------------------------------
# Generate project
#--------------------------------------------------------------------------------------------------

cd $path

$projectGenerator $target . "src/3rdparty/zxing-cpp/"

mv $target.pro $target.pri

cd -
