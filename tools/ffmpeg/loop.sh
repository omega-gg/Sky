#!/bin/sh
set -e

#--------------------------------------------------------------------------------------------------
# Syntax
#--------------------------------------------------------------------------------------------------

if [ $# != 2 -a $# != 3 ] \
   || \
   [ $# = 3 -a "$3" != "reverse" ]; then

    echo "Usage: loop <video> <output> [reverse]"

    exit 1
fi

#--------------------------------------------------------------------------------------------------
# Run
#--------------------------------------------------------------------------------------------------

sh reverse.sh "$1" loop.mp4

if [ "$3" = "reverse" ]; then

    sh concat.sh loop.mp4 "$1" "$2"
else
    sh concat.sh "$1" loop.mp4 "$2"
fi

#--------------------------------------------------------------------------------------------------
# Clean
#--------------------------------------------------------------------------------------------------

rm loop.mp4
