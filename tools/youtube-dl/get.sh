#!/bin/sh
set -e

#--------------------------------------------------------------------------------------------------
# Settings
#--------------------------------------------------------------------------------------------------

youtube_dl="$PWD/bin/youtube-dl"

ffmpeg="$PWD/../ffmpeg/bin/ffmpeg"

#--------------------------------------------------------------------------------------------------
# Syntax
#--------------------------------------------------------------------------------------------------

if [ $# != 1 ]; then

    echo "Usage: get <url>"

    exit 1
fi

#--------------------------------------------------------------------------------------------------
# Run
#--------------------------------------------------------------------------------------------------

"$youtube_dl" -f bestaudio "$1" --output audio.tmp
"$youtube_dl" -f bestvideo "$1" --output video.tmp

"$ffmpeg" -i audio.tmp -i video.tmp -vcodec copy -acodec copy output.mp4

#--------------------------------------------------------------------------------------------------
# Clean
#--------------------------------------------------------------------------------------------------

rm audio.tmp
rm video.tmp
